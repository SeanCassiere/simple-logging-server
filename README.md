# Simple Logging Server

This is a dead simple log server that allows you to log messages to a persisted database.

## Development

1. Clone the repository.
2. Install dependencies `npm install`.
3. Create a `.env` file and add the necessary `secrets` into it. You can use the `.env.example` file as a reference.
4. Run the development server using `npm run dev`. If you haven't run an init on your database, run `npm run db:push`.

## Usage

### Creating a service

To make any logs into the database, you'll need a valid service account which is active. These account should be regulated by yourself, and should not generated by the public.

You can use the `npm run db:explorer` to view the database, and create a service.

### Creating a log

To create a log, a POST request must be sent to the following endpoint `/api/logs`. The payload for this request should be a JSON object with the following fields:

```json
{
  "serviceId": "cl78rvjks0129utq8575twt0g",
  "action": "access-token-requested",
  "environment": "production",
  "ip": "127.0.0.1"
}
```

| Field             | Type                                    | Description                                                |
| ----------------- | --------------------------------------- | ---------------------------------------------------------- |
| serviceId         | String (CUID)                           | The service id of the service that is logging the message. |
| action            | String                                  | The action that is being logged.                           |
| environment       | String <br /> **_default_**: production | The environment that the action is being logged in.        |
| lookupFilterValue | String?                                 | Used for filtering when searching up the records.          |
| ip                | String?                                 | The ip address of the client that is logging the message.  |
| data              | Json?                                   | Any additional metadata to be stored along with this log.  |

### Searching for logs

To view logs, a GET request must be sent to the following endpoint `/api/logs/services/{serviceId}`.

| Field            | Type    | Description                                                |
| ---------------- | ------- | ---------------------------------------------------------- |
| serviceId (path) | String  | The service id of the service that is logging the message. |
| lookup (query)   | String? | Exact matches to the `lookupFilterValue` field above       |
| limit (query)    | Number? | Limit the number of records to return. The default is 500. |

Please note, that this endpoint will return the **LAST** `x` number of logs ordered by their created date.

## Contributing

Contributions are always welcome!

See [CONTRIBUTION](CONTRIBUTION.md) for ways to get started.

Please adhere to this project's [CODE OF CONDUCT](CODE_OF_CONDUCT.md).

![Issues](https://img.shields.io/github/issues/SeanCassiere/simple-logging-server)
![Pull Requests](https://img.shields.io/github/issues-pr-closed/SeanCassiere/simple-logging-server)

## Authors

- [@SeanCassiere](https://github.com/SeanCassiere)
